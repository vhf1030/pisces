{% extends 'base.html' %}

{% block content %}
<div class="container">
    <h1 class="mb-4">어종별 시장 가격 예측</h1>

    <!-- 입력 폼 -->
    <form method="POST">
        {% csrf_token %}
        <div class="mb-3">
            <label for="seafood" class="form-label">어종</label>
            <select name="seafood" id="seafood" class="form-select" required>
                <option value="" disabled {% if not seafood %}selected{% endif %}>선택</option>
                <option value="농어" {% if seafood == "농어" %}selected{% endif %}>농어</option>
                <option value="광어" {% if seafood == "광어" %}selected{% endif %}>광어</option>
                <option value="대게" {% if seafood == "대게" %}selected{% endif %}>대게</option>
                <option value="연어" {% if seafood == "연어" %}selected{% endif %}>연어</option>
                <option value="우럭" {% if seafood == "우럭" %}selected{% endif %}>우럭</option>
                <option value="참돔" {% if seafood == "참돔" %}selected{% endif %}>참돔</option>
                <option value="방어" {% if seafood == "방어" %}selected{% endif %}>방어</option>
            </select>
        </div>
        <div class="mb-3">
            <label for="date" class="form-label">날짜</label>
            <input type="date" name="date" id="date" class="form-control" value="{{ date|default:'' }}" required>
        </div>
        <button type="submit" class="btn btn-primary mt-3">예측하기</button>
    </form>

    {% if prediction %}
        <!-- 결과 출력 -->
        <div class="result-section">
            <h2 class="mb-3">예측 결과</h2>
            <ul class="list-group">
                {% for market, price in prediction.items %}
                <li class="list-group-item"><strong>{{ market }}:</strong> {{ price }}원</li>
                {% endfor %}
            </ul>
            <a href="?" class="btn btn-secondary mt-3">다시 예측하기</a>
        </div>
    {% endif %}
</div>
<script>
    // 오늘 날짜를 기본값으로 설정
    const dateField = document.getElementById('date');
    if (!dateField.value) {
        const today = new Date().toISOString().split('T')[0];
        dateField.value = today;
    }
</script>
{% endblock %}
